<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZPEAKU™</title>
    <link rel="stylesheet" href="/styles/tokens.css">
    <link rel="stylesheet" href="/styles/base.css">
    <link rel="stylesheet" href="/styles/embed.css">
</head>
<body class="z-theme-light">
    <main id="app-container" style="display: none;">
        <h1 class="logo-text">ZPEAKU™ Feed</h1>
        <p>Bienvenido. Carga del contenido universal en curso...</p>

        <button id="logout-btn" class="button button-danger">Cerrar Sesión (Temporal)</button>
        
        </main>

    <script type="module" src="/lib/i18n.js"></script>
    <script type="module">
        import { supa } from '/lib/supa.js'; // RUTA CORREGIDA

        // Lógica de Gating y Redirección de Sesión
        supa.auth.getSession().then(({ data }) => {
            if (!data.session) {
                // No hay sesión, redirigir a Onboarding
                console.log("Sesión no encontrada. Redirigiendo a onboarding.");
                // Asumiendo que /onboarding.html también está en /public/
                window.location.href = '/onboarding.html'; 
            } else {
                // Sesión activa, mostrar la aplicación
                console.log("Sesión activa para usuario:", data.session.user.id);
                document.getElementById('app-container').style.display = 'block';
                // Aquí iría la inicialización del Feed de Shorts (Bloque 3)
            }
        });

        // Lógica de Cierre de Sesión (Temporal)
        document.getElementById('logout-btn').addEventListener('click', async () => {
            const { error } = await supa.auth.signOut();
            if (!error) {
                window.location.href = '/onboarding.html';
            } else {
                console.error("Error al cerrar sesión:", error.message);
                alert("Error al cerrar sesión: " + error.message);
            }
        });
        
        // La lógica de la función t() de i18n se encargará de traducir textos si es necesario
    </script>
</body>
</html>
